<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test MSAL en GitHub Pages</title>
  <script src="https://alcdn.msauth.net/browser/2.38.2/js/msal-browser.min.js"></script>
</head>
<body>
  <h1>Prueba de login con Microsoft</h1>
  <button id="connectBtn">Conectar con Microsoft</button>
  <div id="status"></div>

  <script>
    const msalConfig = {
      auth: {
        clientId: "7d5a8e5f-4d3e-45fa-b3de-f634b9c6b0f8",
        authority: "https://login.microsoftonline.com/common/", // tambi√©n puedes usar tu tenant
        redirectUri: "https://andreseliecergonzalez-afk.github.io/gestor-turnos/"
      }
    };

    const msalInstance = new msal.PublicClientApplication(msalConfig);
    const loginRequest = { scopes: ["Files.ReadWrite", "offline_access"] };

    function setStatus(msg) {
      document.getElementById("status").innerText = msg;
    }

    async function login() {
      try {
        const response = await msalInstance.loginPopup(loginRequest);
        console.log("‚úÖ Login response:", response);
        setStatus("‚úÖ Autenticado: " + response.account.username);

        const tokenResponse = await msalInstance.acquireTokenSilent({
          ...loginRequest,
          account: response.account
        });
        console.log("üîë Token:", tokenResponse.accessToken);
        setStatus("‚úÖ Token obtenido correctamente.");
      } catch (e) {
        console.error("‚ùå Error en login:", e);
        setStatus("‚ùå Error: " + e.message);
      }
    }

    document.getElementById("connectBtn").addEventListener("click", login);
  </script>
</body>
</html>
