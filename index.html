<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Leer Excel de SharePoint</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 5px; text-align: left; }
    th { background: #f4f4f4; }
  </style>
</head>
<body>
  <h1>Tabla desde Excel Online</h1>
  <p id="estado">Cargando datos...</p>
  <table id="tabla"></table>

  <script>
    const url = "https://frontel-my.sharepoint.com/personal/andres_gonzalez_saesa_cl/_layouts/15/Doc.aspx?sourcedoc={77166985-8382-4990-a1d4-09ad8fd64354}&action=default&download=1";

    async function cargarExcel() {
      try {
        const r = await fetch(url);
        if (!r.ok) throw new Error("No se pudo descargar el archivo (cÃ³digo " + r.status + ")");
        const data = await r.arrayBuffer();
        const workbook = XLSX.read(data, { type: "array" });
        const hoja = workbook.Sheets[workbook.SheetNames[0]];
        const filas = XLSX.utils.sheet_to_json(hoja, { header: 1 });
        mostrarTabla(filas);
        document.getElementById("estado").textContent = "";
      } catch (e) {
        document.getElementById("estado").textContent = "Error al cargar: " + e.message;
      }
    }

    function mostrarTabla(data) {
      const tabla = document.getElementById("tabla");
      let html = "";
      data.forEach((fila, idx) => {
        html += "<tr>";
        fila.forEach(celda => {
          html += idx === 0
            ? `<th>${celda ?? ""}</th>`
            : `<td>${celda ?? ""}</td>`;
        });
        html += "</tr>";
      });
      tabla.innerHTML = html;
    }

    cargarExcel();
  </script>
</body>
</html>
