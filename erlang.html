<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Prueba Excel Flow</title>
</head>
<body>
  <h2>Datos desde Excel v√≠a Power Automate</h2>
  <div id="tabla"></div>

  <script>
    async function cargarDatos() {
      const url = "AQUI_TU_URL_DEL_FLUJO"; // pega la URL completa
      try {
        const resp = await fetch(url, { method: "POST" });
        if (!resp.ok) {
          throw new Error("Error HTTP: " + resp.status);
        }
        const data = await resp.json();
        console.log("Datos recibidos:", data);

        if (!Array.isArray(data) || data.length === 0) {
          document.getElementById("tabla").innerHTML = "<p>No hay datos en el Excel.</p>";
          return;
        }

        let html = "<table border='1'><tr>";
        Object.keys(data[0]).forEach(k => html += `<th>${k}</th>`);
        html += "</tr>";
        data.forEach(row => {
          html += "<tr>";
          Object.values(row).forEach(v => html += `<td>${v}</td>`);
          html += "</tr>";
        });
        html += "</table>";

        document.getElementById("tabla").innerHTML = html;
      } catch (err) {
        console.error("Error al cargar datos:", err);
        document.getElementById("tabla").innerHTML = "<p>Error al cargar datos. Revisa consola.</p>";
      }
    }

    cargarDatos();
  </script>
</body>
</html>
