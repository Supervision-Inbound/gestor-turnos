<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Datos desde Excel vÃ­a Power Automate</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    th { background-color: #f4f4f4; }
    .error { color: red; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>Datos desde Excel vÃ­a Power Automate</h2>
  <div id="tabla"></div>
  <div id="mensaje" class="error"></div>

  <script>
    async function cargarDatos() {
      // ðŸ‘‰ URL del Flow de Power Automate
      const flowUrl = "https://prod-31.westus.logic.azure.com:443/workflows/a6c5e734ae1d4bc8a2da0972cf1ed1e0/triggers/manual/paths/invoke?api-version=2016-06-01";

      try {
        const resp = await fetch(flowUrl, { method: "POST" });
        if (!resp.ok) throw new Error("Error HTTP: " + resp.status);

        const data = await resp.json();
        console.log("Datos recibidos:", data);

        if (!Array.isArray(data) || data.length === 0) {
          document.getElementById("tabla").innerHTML = "<p>No hay datos en el Excel.</p>";
          return;
        }

        let html = "<table><tr>";
        Object.keys(data[0]).forEach(k => html += `<th>${k}</th>`);
        html += "</tr>";
        data.forEach(row => {
          html += "<tr>";
          Object.values(row).forEach(v => html += `<td>${v}</td>`);
          html += "</tr>";
        });
        html += "</table>";

        document.getElementById("tabla").innerHTML = html;
      } catch (err) {
        console.error("Error al cargar datos:", err);
        document.getElementById("mensaje").innerText = "Error al cargar datos: " + err.message;
      }
    }

    cargarDatos();
  </script>
</body>
</html>
